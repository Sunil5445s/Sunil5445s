#include <stdio.h>

#define MAX 20
#define INF 999

int a[MAX][MAX], visited[MAX];
int v, e; // v = number of locations, e = number of edges

// Function to input graph
void input() {
    int i, j, from, to, time;
    printf("Enter the number of locations (v): ");
    scanf("%d", &v);

    // Initialize adjacency matrix and visited array
    for(i = 0; i < v; i++) {
        visited[i] = 0;
        for(j = 0; j < v; j++) {
            a[i][j] = INF; // no direct route
        }
    }

    printf("\nEnter the number of edges (connections) (e): ");
    scanf("%d", &e);

    for(i = 0; i < e; i++) {
        printf("Enter the end locations of edge %d: ", i + 1);
        scanf("%d %d", &from, &to);
        printf("Enter the travel time for this edge: ");
        scanf("%d", &time);

        a[from-1][to-1] = time;
        a[to-1][from-1] = time; // undirected graph
    }
}

// Function to display adjacency matrix
void display() {
    int i, j;
    printf("\nAdjacency Matrix (Travel Times):\n");
    for(i = 0; i < v; i++) {
        for(j = 0; j < v; j++) {
            if(a[i][j] == INF)
                printf("INF ");
            else
                printf("%d ", a[i][j]);
        }
        printf("\n");
    }
}

// Function to find minimum delivery time (Prim's algorithm)
void minimumDeliveryTime() {
    int i, j, count;
    int total_Time = 0, min, from = 0, to = 0;

    for(i = 0; i < v; i++)
        visited[i] = 0;

    visited[0] = 1; // start from first location
    printf("\nMinimum Delivery Routes (Using Prim's Algorithm):\n");

    for(count = 0; count < v - 1; count++) {
        min = INF;

        for(i = 0; i < v; i++) {
            if(visited[i]) {
                for(j = 0; j < v; j++) {
                    if(!visited[j] && a[i][j] < min) {
                        min = a[i][j];
                        from = i;
                        to = j;
                    }
                }
            }
        }

        visited[to] = 1; // mark newly added location
        total_Time += min;
        printf("Deliver from Location %d -> Location %d with travel time: %d\n", from+1, to+1, min);
    }

    printf("\nMinimum Total Delivery Time: %d\n", total_Time);
}

int main() {
    int choice;

    do {
        printf("\n========== PIZZA DELIVERY MIN TIME =========\n");
        printf("1. INPUT LOCATIONS AND EDGES\n");
        printf("2. DISPLAY MATRIX\n");
        printf("3. MINIMUM DELIVERY TIME\n");
        printf("4. EXIT\n");
        printf("Enter your choice: ");
        scanf("%d", &choice);

        switch(choice) {
            case 1:
                input();
                break;
            case 2:
                display();
                break;
            case 3:
                minimumDeliveryTime();
                break;
            case 4:
                printf("Exiting program...\n");
                break;
            default:
                printf("Invalid choice!\n");
        }

    } while(choice != 4);

    return 0;
}
